# AstraMC 项目说明文档

## 项目概述

AstraMC（牧云山庄）是一个基于PHP和SQLite的Minecraft Java版服务器网站系统。该项目提供了完整的前端展示页面和后台管理系统，支持服务器信息发布、资源下载、团队介绍、图片展示等功能。

## 技术栈

- 后端语言：PHP
- 数据库：SQLite3
- 前端技术：HTML5, CSS3, JavaScript, jQuery
- 依赖管理：通过CDN引入第三方库

## 项目结构

```
牧云山庄/
├── admin/              # 后台管理系统
├── api/                # API接口
├── assets/             # 静态资源文件
├── install/            # 安装初始化脚本
├── sql/                # SQLite数据库文件
├── index.php           # 前端首页
├── resources.php       # 资源中心页面
└── upload_image.php    # 图片上传页面
```

## 核心功能模块

### 1. 前端展示页面

#### 首页 (index.php)
这是网站的主要入口页面，包含了以下功能模块：
- 服务器状态实时显示
- 服务器特色功能展示
- 玩家作品画廊
- 管理团队介绍
- 资源下载引导
- 加入服务器指引
- 教程文档链接
- 背景音乐和视频

#### 资源中心 (resources.php)
专门用于展示和下载服务器相关资源的页面：
- 提供各类游戏资源包下载
- 支持分类展示不同类型的资源

#### 图片上传 (upload_image.php)
公共图片上传页面：
- 支持批量上传JPG/PNG格式图片
- 每小时限制上传10张图片
- 上传的图片需经管理员审核后展示
- 包含防滥用机制（IP封禁检查）

### 2. 后台管理系统 (admin/)

#### 登录系统
- 用户名/密码认证
- CSRF防护
- 登录尝试次数限制
- 会话超时管理

#### 管理功能模块
- **仪表板**：显示网站各项统计信息
- **公告管理**：发布和管理系统公告
- **服务器设置**：配置服务器相关信息
- **图片审核**：审核用户上传的图片
- **团队管理**：维护管理团队成员信息
- **资源管理**：管理可供下载的资源包
- **IP封禁**：管理封禁的IP地址
- **系统设置**：配置网站基本信息

#### 安全特性
- 安全管理器(SecurityManager)提供统一的安全防护
- CSRF Token验证
- 登录尝试限制
- 会话超时控制
- IP白名单机制
- 密码强度验证
- SQL注入防护

### 3. API接口 (api/)

提供前后端分离的数据接口：
- 服务器地址获取
- 服务器状态查询
- 画廊图片列表
- 团队成员信息
- 资源包信息
- 音乐/视频资源链接
- 教程设置等

### 4. 数据库设计

使用SQLite数据库存储所有网站数据：
- 管理员账户信息
- 服务器设置
- 公告信息
- 团队成员
- 资源包信息
- 画廊图片
- 用户上传图片
- 网站访问日志
- 登录尝试记录
- IP封禁列表

## 主要特性

### 用户功能
1. 浏览服务器信息和状态
2. 查看服务器特色功能
3. 浏览玩家作品画廊
4. 了解管理团队
5. 下载游戏资源包
6. 获取加入服务器的方法
7. 访问教程文档

### 管理功能
1. 完整的后台管理系统
2. 用户认证和权限控制
3. 数据可视化仪表板
4. 内容管理（公告、资源、团队等）
5. 用户上传内容审核
6. 系统日志和监控
7. IP封禁管理
8. 安全防护机制

## 使用Docker部署

### 构建和运行

项目已经包含了Docker配置文件，可以通过以下方式快速部署：

1. 构建Docker镜像：
```bash
docker build -t astramc .
```

2. 运行容器：
```bash
docker run -d -p 8080:80 --name astramc-container astramc
```

或者使用docker-compose：
```bash
docker-compose up -d
```

3. 访问应用：
打开浏览器访问 http://localhost:8080 即可看到网站

### 数据持久化

为了保证数据持久化，推荐使用volume挂载：
```bash
docker run -d -p 8080:80 \
  -v ./sql:/var/www/html/sql \
  -v ./uploads:/var/www/html/uploads \
  --name astramc-container astramc
```

使用docker-compose时，数据卷会自动配置。

### 环境变量

可以通过环境变量调整配置：
- `APACHE_DOCUMENT_ROOT`: Apache文档根目录

## 安装和部署

1. 将项目文件放置在Web服务器目录下
2. 确保PHP环境已配置并启用了SQLite3扩展
3. 系统会自动创建数据库文件(sql/settings.db)
4. 首次访问后台使用默认账户登录：
   - 用户名：admin
   - 密码：admin
5. 登录后请及时修改默认密码

## 安全措施

1. 输入验证和输出转义，防止XSS攻击
2. 参数化查询，防止SQL注入
3. CSRF Token保护，防止跨站请求伪造
4. 登录尝试次数限制，防止暴力破解
5. 会话超时管理
6. IP封禁机制
7. 密码哈希存储
8. 安全头设置

## 自定义配置

1. 可通过修改配置文件来自定义安全参数
2. 支持自定义服务器信息
3. 可配置网站标题、描述等元信息
4. 支持自定义CSS样式

## 维护建议

1. 定期备份数据库文件
2. 及时清理过期的日志数据
3. 定期审查封禁IP列表
4. 监控用户上传内容
5. 更新服务器状态信息